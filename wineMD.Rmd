---
title: "CIS 335: Assignment 1"
author: "Stella Sterling"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load packages, include=FALSE}
#install.packages("tidyverse")
library(tidyverse)
library(kableExtra)
```


### Part 1 & 2

Data downloaded from Kaggle: https://www.kaggle.com/rajyellow46/wine-quality

```{r read in data, include=FALSE}
wineQual <- readr::read_csv(here::here("data","winequalityN.csv"))
```


### Part 3

There are 13 variables: 

| Name    | Attribute   |
|---------|-------------|
| `type` | nominal   |
| `fixed acidity` | numeric (ratio) |
| `volatile acidity` | numeric (ratio) |
| `citric acid` | numeric (ratio) |
| `residual sugar` | numeric (ratio) |
| `chlorides` | numeric (ratio) |
| `free sulfur dioxide` | numeric (ratio) |
| `total sulfur dioxide` | numeric (ratio) |
| `density` | numeric (ratio) |
| `pH` | numeric (interval) |
| `sulphates` | numeric (ratio) |
| `alcohol` | numeric (ratio) |
| `quality` | numeric (ratio), discrete could also be considered categorical |


### Part 4

```{r mode func, include=FALSE}
#function for mode, is mode not a thing in r??
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
```


##### Looking at quality points, `quality`: 

```{r sumstat points, echo=FALSE}
wineQual %>% 
  summarize(
    mean = mean(quality),
    median = median(quality),
    mode = Mode(quality),
    IQR = IQR(quality)) %>% 
  kable(caption="Summary Stats for Quality Points") %>% 
  kable_minimal(full_width=F)
```

```{r points hist, echo=FALSE}
wineQual %>% 
  ggplot(aes(quality)) +
  ggtitle("Quality Points Histogram") +
  geom_histogram(binwidth=.5, fill="salmon")
```

Appears normal; maybe a slight right skew.

##### Looking at fixed acidity, `fixed acidity`: 

```{r sumstat fixed acid, echo=FALSE}
wineQual %>% 
  filter(!is.na(`fixed acidity`)) %>% 
  summarize(
    mean = mean(`fixed acidity`),
    median = median(`fixed acidity`),
    mode = Mode(`fixed acidity`),
    IQR = IQR(`fixed acidity`)) %>% 
  kable(caption="Summary Stats for Fixed Acidity") %>% 
  kable_minimal(full_width=F)
```

```{r fixed acid hist, echo=FALSE}
wineQual %>% 
  filter(!is.na(`fixed acidity`)) %>%
  ggplot(aes(`fixed acidity`)) +
  ggtitle("Fixed Acidity Histogram") +
  geom_histogram(binwidth=.5, fill="salmon")
```

Low-moderate right skew.

##### Looking at alcohol content, `alcohol`:

```{r sumstat alcohol, echo=FALSE}
wineQual %>% 
  filter(!is.na(alcohol)) %>% 
  summarize(
    mean = mean(alcohol),
    median = median(alcohol),
    mode = Mode(alcohol),
    IQR = IQR(alcohol)) %>% 
  kable(caption="Summary Stats for Alcohol Content") %>% 
  kable_minimal(full_width=F)
```

```{r alcohol hist, echo=FALSE}
wineQual %>% 
  filter(!is.na(alcohol)) %>%
  ggplot(aes(alcohol)) +
  ggtitle("Alcohol Content Histogram") +
  geom_histogram(binwidth=.5, fill="salmon")
```

Highly right-skewed.

### Part 5

There appears to be outliers certainly looking at the histograms of the fixed acidity and alcohol content. I computed the IQR for those two variables and quality points in the summary statistics tables above.

##### For `quality` the mean = ~5.82 and the IQR = 1.

```{r quality IQR}
# minor outlier = + or - IQR*1.5; 1(1.5) = 1.5
5.82-1.5
5.82+1.5
```


This means that values less than 4.32 and greater than 7.32 are considered outliers. Quality points are only in whole numbers, so I would consider values less than 4 and greater than 8 minor outliers. The minimum value is 3 and the maximum is 9 for quality points; these values are few and barely minor outliers so I wouldn't remove these observations.

##### For `fixed acidity` the mean = ~7.22 and the IQR = 1.3.

```{r fixed acidity IQR}
7.22 - 1.5*1.3
7.22 + 1.5*1.3
```

Values less than 5.27 and greater than 9.17 considered minor outliers. What would the data look like with these removed?

```{r, echo=FALSE}
wineQual %>% 
  filter(`fixed acidity`>5.27,
         `fixed acidity`<9.17) %>% 
  ggplot(aes(`fixed acidity`)) +
  geom_histogram(binwidth=.2, fill="salmon")
```

Looks better with these removed, however may consider checking out transformations before removing outliers. This is quite a large data set so it doesn't hurt so much to remove this amount of observations (removed about a 1000).

```{r}
wineQual <- wineQual %>% 
  filter(`fixed acidity`>5.27,
         `fixed acidity`<9.17)
```


##### For `alcohol` the mean = ~10.49 and the IQR = 1.8.

```{r alcohol IQR}
10.49 - 1.5*1.8
10.49 + 1.5*1.8
```

Minor outliers would be less than 7.79 and greater than 13.19. This only removes about 100 observations so I would likely not include these outliers. 

```{r, include=FALSE}
wineQual <- wineQual %>% 
  filter(alcohol>7.79,
         alcohol<13.19)
```

### Part 6

alcohol content (`alcohol`) vs `fixed acidity`

```{r}
wineQual %>% 
  filter(!is.na(`fixed acidity`)) %>% 
  ggplot(aes(x=`fixed acidity`, y=alcohol)) +
  geom_point()
```

alcohol content (`alcohol content`) vs ph level (`pH`)

```{r}
wineQual %>%
  ggplot(aes(x=pH, y=alcohol)) +
  geom_point()
```

Neither of these look correlated.



